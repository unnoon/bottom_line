<!DOCTYPE html>
<html>
<head>
    <title>Appending (taking into account broken arrays)</title>
    <script src="../../node_modules/benchmark/benchmark.js"></script>
    <script src="../../src/bottom_line.js"></script>
    <script>
        function append1(arr) {
            var val;
            var start = this.length;

            for(var i = 0, max = arr.length; i < max; i++)
            {
                if((val = arr[i]) === undefined && !arr.hasOwnProperty(i)) continue; // take in account broken arrays
                this[start+i] = val;
            }

            return this;
        }

        function append2(arr) {
            var start = this.length;

            for(var i = 0, max = arr.length; i < max; i++)
            {
                if(!arr.hasOwnProperty(i)) continue; // take in account broken arrays
                this[start+i] = arr[i];
            }

            return this;
        }

        function append3(arr) {
            var start = this.length;

            for(var i = 0, max = arr.length; i < max; i++)
            {
                if(arr[i] === undefined && !arr.hasOwnProperty(i)) continue; // take in account broken arrays
                this[start+i] = arr[i];
            }

            return this;
        }

        var arr1 = [1, 2, 3];
        var arr2 = [];

        arr2[0] = 4;
        arr2[2] = 6;

        var arr3 = [4, 5, 6];

        var suite = new Benchmark.Suite;
        console.log(document.getElementsByTagName('title')[0].text+': running tests...');
        // add tests
        suite
            .add('append1', function() {
                append1.bind(arr1)(arr2);
                append1.bind(arr1)(arr3);
            })
            .add('append2', function() {
                append2.bind(arr1)(arr2);
                append2.bind(arr1)(arr3);
            })
            .add('append3', function() {
                append3.bind(arr1)(arr2);
                append3.bind(arr1)(arr3);
            })
            // add listeners
            .on('cycle', function(event) {
                console.log(String(event.target));
            })
            .on('complete', function() {
                console.log('Fastest is ' + this.filter('fastest').pluck('name'));
            })
            // run async
            .run({ 'async': true });
    </script>
</head>
<body>
</body>
</html>